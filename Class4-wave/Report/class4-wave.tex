% requirements:
%	TeX environments: TeXlive/MacTeX or MiKTeX
%	compiler: XeLaTeX
%
% ---------------------------------------------------------------------------- %
%                                   preamble                                   %
% ---------------------------------------------------------------------------- %
\documentclass[a4paper]{article}
% 10.5pt = 5 hao

% ---------------------------------- layout ---------------------------------- %
\usepackage[a4paper,top=2.5cm,bottom=2.5cm,left=3cm,right=3cm,% margins
			headheight=1.5cm,headsep=1.5em,
			footskip=2em,
			]{geometry}

% ------------------------------- math symbols ------------------------------- %
% 载入常用的数学包, 符号包
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{mathrsfs}
\usepackage{blindtext}

%----------------------------------------------------------------%
%% linespace 行间距，段间距等等
\usepackage{setspace}
% \usepackage{indentfirst} % then the first line of each title should start with a indent.
% 定义标题和段落样式
% 定义1.5倍行距
\renewcommand{\baselinestretch}{1.62}
\setlength{\baselineskip}{12pt}   % set the fixed value of the lineskip
\setlength\parskip{\baselineskip} % set the space between the paragraphs, set the variable \parskip \baselineskip
% parindent
\setlength{\parindent}{0pt}

%----------------------------------------------------------------%
% fonts (style, color, size). 字体的大小，颜色，以及定义常用的字号
\usepackage{ctex}		 	% If you are lazy, the CTEX suit is enough.
% Chinese font
\usepackage{xeCJK}		 	% For the Chinese through XeLaTex
\setCJKmainfont{SimSun} 	% set the mainfont of Chinese as songti. (serif) for
\setCJKsansfont{SimSun} 	% sans serif font for \textsf
\setCJKmonofont{SimSun} 	% monospace font for \texttt
% \punctstyle{kaiming}  	% Remove the space used by symbols like comma. Special for the mainland students like us HUSTers.
\setCJKfamilyfont{song}{SimSun}                       % 宋体 song
\newcommand{\song}{\CJKfamily{song}}
\setCJKfamilyfont{kai}{KaiTi}                         % 楷体  kai
\newcommand{\kai}{\CJKfamily{kai}}
\setCJKfamilyfont{hwzs}{STZhongsong}                  % 华文中宋  hwzs
\newcommand{\hwzs}{\CJKfamily{hwzs}}
\setCJKfamilyfont{hei}{SimHei}                        % 黑体  hei
\newcommand{\hei}{\CJKfamily{hei}}
% English font
\usepackage{fontspec}% Then you can use the fonts installed at your device.
\setmainfont{Times New Roman}
\setsansfont{Times New Roman}
\setmonofont{Times New Roman}
%\setsansfont{[foo.ttf]} % for the fonts at this default path.
% font Color 利用definecolor自己可以定义颜色
\usepackage{xcolor}
\definecolor{MSBlue}{rgb}{.204,.353,.541}
\definecolor{MSLightBlue}{rgb}{.31,.506,.741}
% font Size (I use pinyin represents the corresponding size in Microsorft Word)
% \newcommand{\chuhao}{\fontsize{42pt}{\baselineskip}\selectfont}
\newcommand{\xiaochuhao}{\fontsize{36pt}{\baselineskip}\selectfont}
% \newcommand{\yihao}{\fontsize{28pt}{\baselineskip}\selectfont}
\newcommand{\erhao}{\fontsize{21pt}{\baselineskip}\selectfont}
\newcommand{\xiaoerhao}{\fontsize{18pt}{\baselineskip}\selectfont}
\newcommand{\sanhao}{\fontsize{15.75pt}{\baselineskip}\selectfont}
\newcommand{\sihao}{\fontsize{14pt}{18pt}\selectfont}
\newcommand{\xiaosihao}{\fontsize{12pt}{18pt}\selectfont}
\newcommand{\wuhao}{\fontsize{10.5pt}{18pt}\selectfont}
% \newcommand{\xiaowuhao}{\fontsize{9pt}{\baselineskip}\selectfont}
% \newcommand{\liuhao}{\fontsize{7.875pt}{\baselineskip}\selectfont}
% \newcommand{\qihao}{\fontsize{5.25pt}{\baselineskip}\selectfont}


% ---------------------------------------------------------------------------- %
%% header and footer 页眉，页脚
\usepackage{fancyhdr} % for header and footer

% 设置页眉样式
\newcommand{\headstyle}{
 \fancyhead[C]{ \hwzs\wuhao 华\hspace{0.5em}中\hspace{0.5em}科\hspace{0.5em}技\hspace{0.5em}大\hspace{0.5em}学\hspace{0.5em}课\hspace{0.5em}程\hspace{0.5em}设\hspace{0.5em}计\hspace{0.5em}(报\hspace{0.5em}告)}
}

% 设置页脚样式
\newcommand{\footstyle}{\fancyfoot[C]{\wuhao\thepage}
 \fancyfoot[L]{\rule[5pt]{6.7cm}{0.4pt}}
 \fancyfoot[R]{\rule[5pt]{6.7cm}{0.4pt}}
}
\pagestyle{fancy}
\fancyhf{} % 清空原有样式
\headstyle
\footstyle
% 定义一种新的格式叫做main
\fancypagestyle{main}{%
 \fancyhf{} % 清空原有样式
 \headstyle
 \footstyle
}
\renewcommand{\headrulewidth}{0.4pt}
% \renewcommand{\footrulewidth}{0.4pt}
% \renewcommand{\headrule}{\rule{\textwidth}{0.4pt}}

% ---------------------------------------------------------------------------- %
% set the styles of sections at all levels
% 设置各个标题样式
% 不需要使用part和chapter层级
\usepackage{titlesec}
\usepackage{titletoc}
\titleformat{\section}{\centering\hei\bfseries\xiaoerhao}{\thesection}{1em}{} % 在section标题编号后面加个点
% \titlelabel{\thetitle.\quad} % add a dot after the counter for all levels of sections
% \titleformat*{\section}{\wuhao\bfseries} % 设置标签的形式，5号加粗
\titleformat*{\subsection}{\raggedright\hei\bfseries\sihao}
\titleformat*{\subsubsection}{\raggedright\hei\bfseries\xiaosihao}
\titleformat{\paragraph}[hang]{\raggedright\hei\bfseries\xiaosihao}{\theparagraph}{1em}{}[]

% manual
% \titleformat{command}[shape]{format}{label}{sep}{before-code}[after-code]
% \titlespacing{command}{left}{before-sep}{after-sep}
% 设置新的层级subsubsubsection
\setcounter{tocdepth}{4}
\setcounter{secnumdepth}{4}

% 根据学校要求设置新的section, subsection, subsection,  paragraph

% set the content of section and so on
\newcommand\seccontent{
	\song
	\xiaosihao % 默认五号字体, 行间距为1.5*\baselineskip
    \setlength{\parindent}{2em} % 首段缩进两个M字符
    \setlength{\parskip}{0pt}
    }
\newcommand\tabcontent{
	\song
	\wuhao % 默认五号字体, 行间距为1.5*\baselineskip
	\setlength{\parindent}{2em} % 首段缩进两个M字符
	\setlength{\parskip}{0pt}
}


% ---------------------------------------------------------------------------- %
% for the style of theorems, definitions, proofs and remarks 定义数学里面一些常用的环境
\usepackage{amsthm}
\newtheorem{thm}{\textbf{定理}}[section]
% The section in [] can be replaced by chapter or subsection
\theoremstyle{definition} 
\theoremstyle{plain}
\theoremstyle{remark}

% ---------------------------------------------------------------------------- %
% for the caption and reference 图表及公式的编号规范
\usepackage{float} 		 		  	% table figure positioning
\usepackage{caption}
\captionsetup[figure]{labelformat=default, labelsep=quad,name={图}}
\captionsetup[table]{labelformat=default,labelsep=quad,name={表}}
% 设置图表标题的计数方式
\renewcommand{\thefigure}{\ifnum \thesection>0 \thesection-\fi \arabic{figure}} % set caption label style to 2-1
\renewcommand{\thetable}{\ifnum \thesection>0 \thesection-\fi \arabic{table}} % set caption label style to 2-1
\DeclareCaptionFont{mylabelfont}{\hei\xiaosihao}
\captionsetup[figure]{font=mylabelfont}
\captionsetup[table]{font=mylabelfont}

% 设置图表的autoref的格式
\newcommand{\reffig}[1]{图 \ref{#1}}
\newcommand{\reftab}[1]{表 \ref{#1}}
% 公式的编号格式
\renewcommand\theequation{\arabic{section}-\arabic{equation}}

\usepackage{graphicx} % To include graphixs 添加图所需的包

\graphicspath{{./graphics/}} %设置图片路径
\usepackage{booktabs} % To create three line table including the commands toprule, bottomrule, and midrule
% \usepackage{colortbl} %
% 使用tabularx库并定义新的左右中格式
\usepackage{tabularx}
\usepackage{makecell}
\newcolumntype{L}{X}
\newcolumntype{C}{>{\centering \arraybackslash}X}
\newcolumntype{R}{>{\raggedright \arraybackslash}X}

% ---------------------------------------------------------------------------- %
% set the style of counters 设置计数器
% 设置重新计数的位置
\makeatletter
\@addtoreset{footnote}{page}
\@addtoreset{figure}{section}
\@addtoreset{table}{section}
\@addtoreset{equation}{section}
\makeatother

% ---------------------------------------------------------------------------- %
% tableofcontents, listoftables and listoffigures 目录
%\renewcommand\listfigurename{插图列表}
%\renewcommand\listtablename{表格列表}
%\titlecontents{标题名}[左间距]{标题格式}{标题标志}{无序号标题}{指引线与页码}[下间距]
%\dottedcontents{section}[2.55em]{\song \xiaosihao \bfseries}{2.5em}{1em}
\usepackage{tocloft}
\renewcommand{\contentsname}{\centerline{ \hei\bfseries\xiaoerhao 目\hspace{2em}录}}
\titlecontents{section}[3em]{\song\xiaosihao\bfseries}{\contentslabel{3em}}{\hspace*{-3em}}{\normalfont\titlerule*[8pt]{.}\contentspage}
\titlecontents{subsection}[3em]{\song\xiaosihao}{\contentslabel{3em}}{\hspace*{-3em}}{\titlerule*[8pt]{.}\contentspage}
\titlecontents{subsubsection}[4em]{\song\xiaosihao}{\contentslabel{4em}}{\hspace*{-4em}}{\titlerule*[8pt]{.}\contentspage}
\titlecontents{paragraph}[5em]{\song\xiaosihao}{\contentslabel{5em}}{\hspace*{-5em}}{\titlerule*[8pt]{.}\contentspage}


% ---------------------------------------------------------------------------- %
% 设置声明页
% 使用特殊符号
\usepackage{amssymb}
\usepackage{wasysym}


% ---------------------------------------------------------------------------- %
%	---	定义列表项，列举的样式
\usepackage{enumitem}
\setlist{noitemsep}

% ---------------------------------------------------------------------------- %
% \usepackage{makeindex} For the index 索引
\usepackage{listings} % For the code. 代码
\usepackage{multirow}
% ---------------------------------------------------------------------------- %
% 设置脚注

% ---------------------------------------------------------------------------- %
%% For the hyperlink and bookmark 超链接及书签，(这样生成的pdf中的引用直接点击链接即可到达目的地)
\usepackage[bookmarks=true,colorlinks,linkcolor=black,citecolor=black,urlcolor=purple]{hyperref}% 设置超链接并修改风格


% ---------------------------------------------------------------------------- %
%% For the appendix, 附录
% 设置附录
\usepackage{appendix}
\renewcommand{\appendixname}{附录}

% ---------------------------------------------------------------------------- %
% for the titlepage 标题页，此处可以省略，建议直接使用官方给出的标题页即可
\usepackage{titling}
% 重置命令 maketitle
\renewcommand{\maketitle}{
	\def\HUSTtitlelength{12em}
 	\begin{titlepage}
		\begin{center}
			\vspace*{0em}
			\includegraphics[height=1.61cm]{HUSTlogo.eps}\\
%
			\vspace*{4em}
%
			{\xiaochuhao \hwzs \bfseries 电子线路实验报告}\\
%
			\vspace*{6em}
			{\erhao \hei \bfseries \thetitle}

			\vspace*{6em}
			{\sanhao \hwzs
				\renewcommand\arraystretch{2.7}
				\begin{tabular}{lc}
					\makebox[4em][s]{院 \hfill 系} &
					\underline{\makebox[\HUSTtitlelength]{\school}} \\
					\makebox[4em][s]{专业班级} &
					\underline{\makebox[\HUSTtitlelength]{\classnum}} \\
					\makebox[4em][s]{姓 \hfill 名} &
					\underline{\makebox[\HUSTtitlelength]{\theauthor}} \\
					\makebox[4em][s]{学 \hfill 号} &
					\underline{\makebox[\HUSTtitlelength]{\stunum}} \\
					\makebox[4em][s]{指导教师} &
					\underline{\makebox[\HUSTtitlelength]{\instructor}} \\
			  \end{tabular}
		    }

			\vspace{4em}
			{\sanhao \hwzs \thedate}

		\end{center}
	\end{titlepage}
}


% ------------------------------------ 标题页 ----------------------------------- %
\title{信号产生和变换电路} % 论文题目
\def\school{电子信息与通信学院} % 院系
\def\classnum{信卓2201班} % 专业班级
\author{董浩} % 姓名
\def\stunum{U202213781}	% 学号
\def\instructor{陈林} % 指导老师
\date{\today} % 日期


% ---------------------------------------------------------------------------- %
%                                   document                                   %
% ---------------------------------------------------------------------------- %
\begin{document}

\maketitle


\tableofcontents
\thispagestyle{main}

\clearpage
\setcounter{page}{1}
\renewcommand{\thepage}{\arabic{page}}

% ----------------------------------- 主体内容 ----------------------------------- %
\seccontent

\section{实验名称}
信号的产生、分解与合成
\section{实验目的}
设计一个信号产生、分解与合成电路，能够产生所需频率的方波，和三角波，并对所产生的方波进行滤波分解，产生多个不同频率的正弦信号，再将这些信号再合成为近似方波信号
\section{实验元器件}
\begin{table}[H]
	\center
	\begin{tabularx}{0.8\textwidth}{|X|X|X|}
		\hline
		名称                  & 型号（参数） & 数量 \\ \hline
		运算放大器               & NE5532 & 3  \\ \hline
		\multirow{5}{*}{电阻} & 5.1KΩ  & 1  \\ \cline{2-3}
		                    & 10KΩ   & 3  \\ \cline{2-3}
		                    & 20KΩ   & 1  \\ \cline{2-3}
		                    & 47KΩ   & 1  \\ \cline{2-3}
		                    & 100KΩ  & 1  \\ \hline
		\multirow{2}{*}{电容} & 0.1μF  & 1  \\ \cline{2-3}
		                    & 0.01μF & 1  \\ \hline
	\end{tabularx}
\end{table}
\section{实验任务}
\begin{enumerate}
	\item 设计信号产生电路：能够产生频率为5KHz峰峰值为10V的方波，再由方波生成对应频率，峰峰值为6V的三角波。
	\item 设计信号分解、合成电路：对所产生的方波进行滤波分解，产生该方波的一次、三次谐波正弦信号，再将这些信号再合成为近似方波信号。
\end{enumerate}


\section{实验原理}
\subsection{信号发生电路}
\begin{figure}[H]
	\centering
	\includegraphics[width=1\textwidth]{信号发生}
	\caption{信号发生}
	\label{信号发生}
\end{figure}
对于同向迟滞比较器，有:
\begin{equation}
	V_+ = \frac{R_2}{R_2+R_3+RP_1}V_{o_1}+\frac{R_3+RP_1}{R_2+R_3+RP_1}V_{ia}
\end{equation}
其中：
\begin{equation}
	V_{ia} = \frac{R_2}{R_2+R_3+RP_1}V_{o1}
\end{equation}
故有：
\begin{equation}
	V_{T-} = \frac{-R_2}{R_3+RP_1}V_{CC},V_{T+}=\frac{R_2}{R_3+RP_1}V_{CC}
\end{equation}
即得到方波。

对于反向积分器，有：
\begin{equation}
	v_{o2}=-\frac{1}{C_2}\int_{t_0}^{t_1} \frac{v_{o_1}}{R_4+RP_2}dt-v_{c2}(t_0)=\pm \frac{v_{CC}}{(R_4+RP_2)C_2}+v_{o2}(t_0)
\end{equation}
输出$v_{o1}$为高电平（$+v_{CC}$) ，比较器门限电压为$V_{T-}$。这时积分器开始反向积分，三角波vo2线性下降。当vo2下降到$V_{T-}$时，比较器翻转，输出$v_{o1}$由高电平跳到低电平,门限电压为$V_{T+}$这时积分器又开始正向积分，$v_{o2}$线性增加。如此反复，就可自动产生方波-三角波。

\subsection{信号分离电路}
\begin{figure}[H]
	\centering
	\includegraphics[width=1\textwidth]{二阶低通滤波器.png}
	\caption{二阶低通滤波器}
	\label{二阶低通滤波器}
\end{figure}
特征角频率
$$
	\begin{aligned}
		\omega_0 = \frac{1}{\sqrt{C_1C_2R_1R_2}} \\
		f_0=\frac{1}{2\pi \sqrt{C_1C_2R_1R_2}}   \\
		Q=\frac{\sqrt{C_1C_2R_1R_2}}{C_2(R_1+R_2)}
	\end{aligned}
$$
设计二阶巴特沃斯低通滤波器如\reffig{二阶低通设计}所示，特征频率5KHz：
\begin{figure}[H]
	\centering
	\includegraphics[width=0.6\textwidth]{二阶低通设计}
	\caption{二阶低通设计}
	\label{二阶低通设计}
\end{figure}
设计二阶巴特沃斯带通滤波器如\reffig{二阶带通设计}所示，特征频率15KHz,带宽2.5KHz：
\begin{figure}[H]
	\centering
	\includegraphics[width=0.8\textwidth]{二阶带通设计}
	\caption{二阶带通设计}
	\label{二阶带通设计}
\end{figure}
\subsection{信号合成电路}
先使用移相器获得相位相同的波形，再使用加法器电路合成两波形，如\reffig{移项与合成电路}所示：
\begin{figure}[H]
	\centering
	\includegraphics[width=0.8\textwidth]{移项与合成电路.png}
	\caption{移项与合成电路}
	\label{移项与合成电路}
\end{figure}

\section{仿真分析}
\subsection{信号发生电路}
\begin{figure}[H]
	\centering
	\includegraphics[width=1\textwidth]{信号发生仿真}
	\caption{信号发生仿真}
	\label{信号发生仿真}
\end{figure}

\subsection{低通滤波}
\begin{figure}[H]
	\centering
	\includegraphics[width=1\textwidth]{二阶低通仿真}
	\caption{二阶低通仿真}
	\label{二阶低通仿真}
\end{figure}
\subsection{带通滤波}

\begin{figure}[H]
	\centering
	\includegraphics[width=1\textwidth]{二阶带通仿真.png}
	\caption{二阶带通仿真}
	\label{二阶带通仿真}
\end{figure}
\section{实验过程}
如图所示连接电路，调整电位器阻值合适后接入电路，微调电位器，调整方波和三角波的频率和峰峰值至符合要求。搭建滤波器电路时，在电源和地间加入适当的滤波电容。波形符合要求，通过验收。

\section{实验总结}
方波的幅度由$+V_{CC}$和$–V_{EE}$决定，小于它们1V左右；三角波幅度可由$R_{P1}$进行调节，但会影响频率。调节$R_{P2}$，可调节频率，且不会影响三角波幅度，可用$R_{P2}$实现频率微调，用$C_2$改变频率范围。
误差分析：
测量存在误差和实验电路的局限性，输出的波形并不是标准的方波和三角波，而是有一些杂量。

此外，滤波电路需要特别注意连线，否则会出现高频自激。

% ------------------------------------ 附录 ------------------------------------ %
\clearpage
\appendix
\phantomsection

\end{document}
